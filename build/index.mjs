import e from"styled-components";import r,{useRef as n,useState as o,useEffect as t}from"react";import a from"prop-types";import l from"react-dom";var c=e.div.withConfig({displayName:"baseStyles__BaseModalBackground"})(["display:flex;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:30;background-color:rgba(0,0,0,0.5);align-items:center;justify-content:center;"]);var u=function(e){if(Array.isArray(e))return e};var i=function(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],o=!0,t=!1,a=void 0;try{for(var l,c=e[Symbol.iterator]();!(o=(l=c.next()).done)&&(n.push(l.value),!r||n.length!==r);o=!0);}catch(e){t=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(t)throw a}}return n}};var f=function(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,o=new Array(r);n<r;n++)o[n]=e[n];return o};var p=function(e,r){if(e){if("string"==typeof e)return f(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,r):void 0}};var d=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var s=function(e,r){return u(e)||i(e,r)||p(e,r)||d()},y=r.createContext({}),m=y.Provider,v=y.Consumer;function b(e){var a=e.backgroundComponent,l=e.children,u=n(null),i=o(null),f=s(i,2),p=f[0],d=f[1],y=o(c),v=s(y,2),b=v[0],g=v[1];return t((function(){a&&g(a)}),[g,a]),t((function(){d(u.current)}),[d,u]),r.createElement(m,{value:{modalNode:p,BackgroundComponent:b}},l,r.createElement("div",{ref:u}))}b.propTypes={backgroundComponent:a.oneOfType([a.element,a.object])};var g,h,w=(g=function(e){function r(){return e.exports=r=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r.apply(this,arguments)}e.exports=r},g(h={exports:{}},h.exports),h.exports);var O=function(e,r){if(null==e)return{};var n,o,t={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],r.indexOf(n)>=0||(t[n]=e[n]);return t};var C=function(e,r){if(null==e)return{};var n,o,t=O(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t};function k(e){var a,c=e.WrapperComponent,u=e.children,i=e.onBackgroundClick,f=e.onEscapeKeydown,p=e.allowScroll,d=e.beforeOpen,y=e.afterOpen,m=e.beforeClose,b=e.afterClose,g=e.backgroundProps,h=e.isOpen,O=C(e,["WrapperComponent","children","onBackgroundClick","onEscapeKeydown","allowScroll","beforeOpen","afterOpen","beforeClose","afterClose","backgroundProps","isOpen"]),k=n(null),j=n(null),E=n(!1),x=o(!1),S=s(x,2),P=S[0],B=S[1];function A(e){k.current===e.target&&i&&i(e)}return t((function(){function e(e){B(e),e?y():b()}function r(r){if(r){var n=r();"function"==typeof(null==n?void 0:n.then)?(E.current=!0,n.then((function(){e(h),E.current=!1}))):e(h)}else e(h)}P===h||E.current||r(h?d:m)}),[E,P,h,d,m,b,y]),t((function(){function e(e){"Escape"===e.key&&f&&f(e)}return P&&document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[P,f]),t((function(){return P&&!p&&(j.current=document.body.style.overflow,document.body.style.overflow="hidden"),function(){p||(document.body.style.overflow=j.current||"")}}),[P,p]),a=c?r.createElement(c,O,u):u,r.createElement(v,null,(function(e){var n=e.modalNode,o=e.BackgroundComponent;return n&&o&&P?l.createPortal(r.createElement(o,w({},g,{onClick:A,ref:k}),a),n):null}))}k.styled=function(){for(var n=arguments.length,o=new Array(n),t=0;t<n;t++)o[t]=arguments[t];var a=o?e.div.withConfig({displayName:"Modal__wrap"}).apply(void 0,o):e.div.withConfig({displayName:"Modal__wrap"})();return function(e){return r.createElement(k,w({WrapperComponent:a},e))}},k.defaultProps={backgroundProps:{}},k.propTypes={WrapperComponent:a.oneOfType([a.element,a.object]),onBackgroundClick:a.func,onEscapeKeydown:a.func,allowScroll:a.bool,beforeOpen:a.func,afterOpen:a.func,beforeClose:a.func,afterClose:a.func,backgroundProps:a.object,isOpen:a.bool},k.ModalProvider=b,k.BaseModalBackground=c;export{k as default};
